<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Events â€” Cards from Google Sheet</title>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --accent:#7c3aed; --glass: rgba(255,255,255,0.04);
      --glass-2: rgba(255,255,255,0.02);
      --text:#e6eef8;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial;
      background: radial-gradient(1000px 500px at 10% 10%, rgba(124,58,237,0.12), transparent),
                  radial-gradient(700px 400px at 90% 90%, rgba(14,165,233,0.06), transparent),
                  var(--bg);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding:40px;
    }
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:24px}
    header h1{margin:0;font-size:22px;letter-spacing:0.2px}
    header p{margin:0;opacity:0.8}

    .grid{
      display:grid;
      grid-template-columns:repeat(2,1fr);
      gap:20px;
      align-items:start;
    }
    @media (max-width:860px){.grid{grid-template-columns:1fr}}

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.12));
      border: 1px solid rgba(255,255,255,0.04);
      padding:18px;
      border-radius:14px;
      box-shadow: 0 6px 18px rgba(2,6,23,0.6), inset 0 1px 0 rgba(255,255,255,0.02);
      transition: transform 450ms cubic-bezier(.2,.9,.2,1), box-shadow 350ms;
      transform-origin:center;
      overflow:hidden;
      position:relative;
      min-height:220px;
    }
    .card:hover{transform:translateY(-10px) scale(1.01); box-shadow:0 18px 40px rgba(12,20,40,0.6)}

    .card .top{
      display:flex;align-items:center;justify-content:space-between;margin-bottom:10px
    }
    .badge{
      padding:6px 10px;border-radius:999px;font-size:12px;font-weight:600;background:linear-gradient(90deg,var(--accent),#06b6d4);
      color:white;box-shadow:0 6px 18px rgba(124,58,237,0.15);
      transform:translateZ(0);
    }
    .title{font-size:18px;font-weight:700;margin:0}
    .meta{font-size:13px;opacity:0.85;margin-top:6px}

    .cols{display:flex;gap:12px;margin-top:12px}
    .col{flex:1}
    .small{font-size:13px;line-height:1.35;color:rgba(230,238,248,0.92)}
    .rules{max-height:80px;overflow:auto;padding-right:6px}

    .footer{
      display:flex;gap:10px;align-items:center;justify-content:space-between;margin-top:14px
    }
    .sponsors{font-size:12px;opacity:0.8}

    /* Register button 3D */
    .btn-3d{
      --depth:6px;
      background:linear-gradient(180deg,#111827,#0b1220);
      border-radius:10px;padding:10px 16px;font-weight:700;border:0;cursor:pointer;
      box-shadow: 0 calc(var(--depth)) 0 rgba(0,0,0,0.6), 0 8px 30px rgba(2,6,23,0.45);
      color:var(--text);transform:translateY(0);transition:transform 180ms, box-shadow 180ms;
      display:inline-flex;align-items:center;gap:8px
    }
    .btn-3d:active{transform:translateY(4px);box-shadow:0 2px 10px rgba(2,6,23,0.5)}

    /* subtle floating decorative */
    .card::after{
      content:"";position:absolute;right:-60px;top:-40px;width:160px;height:160px;border-radius:50%;
      background:linear-gradient(180deg, rgba(124,58,237,0.12), transparent);
      filter: blur(30px);transform:rotate(20deg);pointer-events:none;opacity:0.9
    }

    /* Loading */
    .loading{display:flex;align-items:center;gap:10px}
    .dot{width:8px;height:8px;border-radius:50%;background:var(--accent);animation:blink 1s infinite}
    .dot:nth-child(2){animation-delay:.12s}.dot:nth-child(3){animation-delay:.24s}
    @keyframes blink{0%{opacity:.18;transform:scale(.85)}50%{opacity:1;transform:scale(1.1)}100%{opacity:.18;transform:scale(.85)}}

    /* label chip */
    .chip{padding:6px 8px;background:var(--glass);border-radius:8px;font-size:12px;border:1px solid var(--glass-2)}
  </style>
</head>
<body>
  <header>
    <div>
      <h1>College Hackaton</h1>
      <p>WELCOME TO COLLEGE Hackaton</p>
    </div>
  </header>

  <main>
    <div id="grid" class="grid">
      <!-- cards injected here -->
    </div>
    <div id="status" style="margin-top:16px;color:rgba(230,238,248,0.7)"></div>
  </main>

  <script>
    // ---------- CONFIG ----------
    // 1) Publish your Google Sheet: File -> Publish to web -> Entire document or the specific sheet
    // 2) Make the sheet viewable to anyone with the link (Share -> Anyone with link -> Viewer)
    // 3) Replace SHEET_ID and SHEET_NAME below

    const SHEET_ID = '1ScFhI0F6HpzEKraofb1CXK_JWaP3fJ71ftSCsYjv9Lw'; // <-- replace
    const SHEET_NAME = 'Hackthon 99.1';

    const statusEl = document.getElementById('status');
    const grid = document.getElementById('grid');

    function setStatus(txt){statusEl.textContent = txt}
    function showLoading(){grid.innerHTML = `<div class="card"><div class="loading"><div class="dot"></div><div class="dot"></div><div class="dot"></div><div>Loading events from Google Sheet...</div></div></div>`}

    showLoading(); setStatus('Attempting to fetch events...');

    // Build gviz URL
    const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${encodeURIComponent(SHEET_NAME)}`;

    fetch(url).then(r=>r.text()).then(txt=>{
      // gviz responds with a JS function call wrapper. Extract JSON inside the parentheses.
      const start = txt.indexOf('(');
      const end = txt.lastIndexOf(')');
      const jsonStr = txt.substring(start+1,end);
      const data = JSON.parse(jsonStr);

      const cols = data.table.cols.map(c=>c.label.trim());
      const rows = data.table.rows || [];

      if(rows.length === 0){ grid.innerHTML = ''; setStatus('No events found in the sheet.'); return }

      // Convert rows to objects using header labels (case-insensitive)
      const events = rows.map(r=>{
        const obj = {};
        r.c.forEach((cell,i)=>{
          const key = cols[i] || `col${i}`;
          obj[key] = cell && cell.v !== null ? cell.v : '';
        });
        return obj;
      });

      // Helpful mapping - try to find common header names
      function getField(ev, names){
        names = Array.isArray(names)?names:names.split('|');
        names = names.map(s=>s.toLowerCase().trim());
        for(const k of Object.keys(ev)){
          if(names.includes(k.toLowerCase())) return ev[k];
        }
        return '';
      }

      grid.innerHTML = '';

      events.forEach(ev=>{
        const name = getField(ev, ['Event Name','Name','title','event']);
        const rules = getField(ev, ['Rules','rule','details','description']);
        const timeline = getField(ev, ['Timeline','Date','time','schedule']);
        const prizes = getField(ev, ['Prizes','Prize','Rewards']);
        const sponsors = getField(ev, ['Sponsors','Sponsor']);
        const mode = getField(ev, ['Mode','Type','Online/Offline','online/offline']);
        const register = getField(ev, ['Registration Link','Register','Link']);

        const card = document.createElement('div'); card.className='card';
        card.innerHTML = `
          <div class="top">
            <div>
              <div class="title">${escapeHtml(name || 'Untitled Event')}</div>
              <div class="meta">${escapeHtml(timeline || 'Date not specified')}</div>
            </div>
            <div class="badge">${escapeHtml(mode || 'Mode')}</div>
          </div>

          <div class="cols">
            <div class="col">
              <div style="font-size:13px;opacity:0.8;margin-bottom:6px;font-weight:700">Rules</div>
              <div class="small rules">${escapeHtml(rules || 'No rules provided')}</div>
            </div>
            <div class="col">
              <div style="font-size:13px;opacity:0.8;margin-bottom:6px;font-weight:700">Prizes</div>
              <div class="small">${escapeHtml(prizes || 'N/A')}</div>
            </div>
          </div>

          <div class="footer">
            <div class="sponsors">Sponsors: ${escapeHtml(sponsors || 'None')}</div>
            <div style="display:flex;gap:10px;align-items:center">
              <button class="btn-3d" onclick="onRegister('${encodeURIComponent(register)}', event)">Register Now</button>
            </div>
          </div>
        `;

        grid.appendChild(card);
      });

      setStatus(`Loaded ${events.length} events.`);

    }).catch(err=>{
      console.error(err);
      grid.innerHTML = '';
      setStatus('Failed to fetch sheet. Make sure SHEET_ID is correct and the sheet is published & shareable. See console for details.');
    });

    function onRegister(encodedLink, e){
      const btn = e.currentTarget; btn.disabled=true;
      const link = decodeURIComponent(encodedLink) || '#';
      if(!link || link === '#'){
        // open a modal or simply alert
        alert('Registration link not provided in the sheet. You can collect registrations via Google Form or an external URL.');
        btn.disabled=false; return;
      }
      // open link in new tab
      window.open(link,'_blank');
      btn.disabled=false;
    }

    // small utility to avoid HTML injection from sheet cells
    function escapeHtml(s){
      if(s === null || s === undefined) return '';
      return String(s)
        .replaceAll('&','&amp;')
        .replaceAll('<','&lt;')
        .replaceAll('>','&gt;')
        .replaceAll('"','&quot;')
        .replaceAll("'","&#39;");
    }
  </script>
</body>
</html>
